function Fmeta = vasodilator_signal(Fmeta_t, index1, indx, cond_leng, n)
Fmeta = zeros(n,1);
FAd1 = Fmeta_t*ones(length(index1),1);
%                  FAd1 = [0.680802325220521,0.690654081817705,0.615535379128017,0.535751974085749,0.479975023880765,0.764033378063699,0.399608022699510,0.786700530177271,0.985076338957167,0.794304210380667,0.496278056461754,0.699121330768813,0.378118586907524,0.779628288009349,0.446970382849995,0.925221411113764,0.809622380291570,0.830442283961942,0.913765960962922,0.664171010628972,0.845874716020557,0.584269524281631,1,0.924673593373611,1,1,0.736043911014751,0.831341293214734,0.647541666041064,0.796488612490973,0.733561479679466,0.559303109249432,0.814984822964174,1,1,0.969565743547117,1,1,1,1,0.658752099761802,0.723055343702026,0.738294869119064,0.273764284747029,0.434475574932354,0.424458746872909,0.526779660353202,0.549851261156741,0.656861944129940,0.551329272666848,0.933168131533247,1,1,0.882193348371034,0.808830619729373,0.809294452458026,0.879371891124264,1,1,1,0.775007835328520,0.676773510409690,0.988877545532906,0.937500000000000,1,1,1,0.806785084011923,0.909427324413631,1,1,0.774361620721125,0.593425947653922,1,1,1,1,1,1];
%FAd1 = [0.294473305908815,0.294473305903562,0.268516740939815,0.623198727165552,0.405402958585289,0.862502198861484,0.862502198829063,1,1,0.549105590885712,0.549105590878854,0.365466103848734,0.365466103844876,0.298431177497370,0.349545161883666,0.363810684546768,0.685118910571485,0.404892064645080,0.549213029614559,0.923969518740615,0.365657415840069,0.308007560132270,0.331472824894742,0.799733707716148,0.799733707705244,0.292122740761713,1,1,1,1,1,1,1,1,0.350274223210859,0.436936984238980,0.917863077807484,0.734773967823009,1,1,0.523148774403908,0.579647967571900,0.796582997673867,0.969432162890360,0.992058780767372,0.465273360997438,0.663844108854551,0.499731044710302,0.499731044718347,0.484425131036746,0.428521854105974,0.515409220605006,0.515409220544056,0.430742601556204,0.349686687163580,0.600698545050694,0.706348904380597,0.706348904380225,0.901202632127959,0.604984758573290,0.700296024513680,0.629789228974637,0.629789228958090,0.797171143808298,0.797171143793097,0.933388771958223,1,1,0.437029073676196,0.437029073633244,1,1,1,0.612275693735424,0.500623907469224,0.635485380312933,0.486525706072036,0.281320809790094,1,0.437135381977906,0.484227689188294,0.880402914232652,0.572580755842981,0.819021398166004,0.819021398180553,0.552085133392007,1,1,0.841341557653740,0.800726020473511,0.800726020439501,0.896393148094132,0.896393148096279,0.651101730034066,0.434481682889707,0.744704177892097,1,1,0.715241462056377,0.811343915050785,0.681307260492826,0.334805364594234,0.532303324885266,0.862488271281856,0.332504566477862,1,1,1,1,0.873903294745149,0.593786676323139,0.755981814336543,1,1,1,1,1,0.831210300527879,1,1,1,1,0.787905879029321,0.905430665613414,0.905430665566496,0.917282151431637,1,1,1,1,1,1,0.529488385347770,1,1,1,1,1,0.975748912859000,1,0.515916622107837,0.515916622760973,0.400737242088371,0.617901599221962,0.617901599260340,0.473445200873477,1,1,1,0.976396639910828,1,1,1,1,1,1,1,1,1,1,1,0.971089981204550,0.922501353417825,0.922501353429334,0.883922141041894,1,1,1,1,1,1,0.956588712197022,0.675877876910114,1,1,1,1,1,1,1,1,1,0.983222785991193,1,1,0.890598173354585,1,1,1,1,1,0.992779543792898,0.794287167743062,0.794287167728796,0.702209333928768,0.702209333949512,1,1,1,0.558449126516395,0.911478947504604,1,1,1,1,1,1,1,1,1,1,1,1,1,0.675574000380505,0.675574000321580,0.548901706841132,0.548901706871451,0.956553421870270,1,0.870223422413414,0.889783354000584,0.960961515685336,1,0.988586360176658,0.988586360196914,0.988915140098456,0.919619388145300,1,1,1,1,1,1,1,1,1,1,0.741547952351025,1,0.885808874968460,0.942319719998410,1,1,1,0.972984359121757,1,1,1,1,0.967949668952503,1,1,1,0.939982557842403,1,1,1,1,1,1,0.953297114837160,1,1,1,1,1,1,1,1,0.990184133460336,1,0.903259482258206,1];
Fmeta(index1,1)=FAd1;                                      % Calculate the mean conducted signal of terminal vessels belonging to a certain vessel
for i = 1:n
    term_vess_order1 = nonzeros(indx.indx(i,:));
    cond_leng_order1 = nonzeros(cond_leng(i,:));
    index2 = 0;
    if(term_vess_order1)
        for j = 1:length(term_vess_order1)
            index2(j,1) = find(index1 == term_vess_order1(j,1));
            Fmeta(i) = Fmeta(i) + FAd1(index2(j,1))*exp(-cond_leng_order1(j)/1);
        end
        Fmeta(i) = Fmeta(i)/length(term_vess_order1);
    end
end